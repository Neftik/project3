# Project3 üöÄ

## –û –ø—Ä–æ–µ–∫—Ç–µ üõ†Ô∏è

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π. –ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç –≤–æ—Ä–∫–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è. –í—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ! üòé

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ üìÇ

```
api/       # gRPC –∏ proto —Ñ–∞–π–ª—ã
cmd/       # –ó–∞–ø—É—Å–∫ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –∞–≥–µ–Ω—Ç–∞
internal/  # –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pkg/       # –£—Ç–∏–ª–∏—Ç—ã –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è üß∞

### –° Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) üê≥

- Docker 24.0+
- Docker Compose

### –ë–µ–∑ Docker üõ†Ô∏è

- Go 1.20+
- Protocol Buffers (protoc)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ üöÄ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```sh
git clone https://github.com/Neftik/project3.git
cd ./project3
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```sh
go mod tidy
```

### –ó–∞–ø—É—Å–∫

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –∏ —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```sh
TIME_ADDITION_MS=<–ó–ù–ê–ß–ï–ù–ò–ï>
TIME_SUBTRACTION_MS=<–ó–ù–ê–ß–ï–ù–ò–ï>
TIME_MULTIPLICATIONS_MS=<–ó–ù–ê–ß–ï–ù–ò–ï>
TIME_DIVISIONS_MS=<–ó–ù–ê–ß–ï–ù–ò–ï>
COMPUTING_POWER=<–ó–ù–ê–ß–ï–ù–ò–ï>
ORCHESTRATOR_ADDRESS=<–ó–ù–ê–ß–ï–ù–ò–ï> # "localhost:8080" –±–µ–∑ Docker; "orchestrator:8080" —Å Docker
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:

#### –° –ø–æ–º–æ—â—å—é Go üèÉ‚Äç‚ôÇÔ∏è

- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:

```sh
go run ./cmd/orchestrator/cmd.go
```

- –ê–≥–µ–Ω—Ç:

```sh
go run ./cmd/agent/cmd.go
```

#### –° –ø–æ–º–æ—â—å—é Docker üê≥

```sh
docker-compose up --build
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã üß©

### –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä üéõÔ∏è

- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–∑–±–∏–≤–∞–µ—Ç –∏—Ö –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç—É.
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (JWT —Ç–æ–∫–µ–Ω).

### –ê–≥–µ–Ω—Ç ü§ñ

- –ü–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á–∏ –æ—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç—Å—è `COMPUTING_POWER`.

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ üì°

- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**

```sh
curl --location 'localhost:8080/api/v1/register' \
--header 'Content-Type: application/json' \
--data '{"login": "Neftik", "password": "123"}'
```

- **–õ–æ–≥–∏–Ω:**

```sh
curl --location 'localhost:8080/api/v1/login' \
--header 'Content-Type: application/json' \
--data '{"login": "Neftik", "password": "123"}'
```

- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:**

```sh
curl --location 'localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω' \
--data '{"expression": "2+2*2"}'
```

- **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–π:**

```sh
curl --location 'localhost:8080/api/v1/expressions' \
--header 'Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω'
```

- **–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ ID:**

```sh
curl --location 'localhost:8080/api/v1/expressions/1' \
--header 'Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω'
```
